<!DOCTYPE html>
<html lang="en">
<head>
  <base href="$FLUTTER_BASE_HREF">

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <meta name="description" content="AeraSync: Compare aerators for shrimp farming with a step-by-step survey, view ranked results, and download a detailed PDF report.">
  <meta name="keywords" content="AeraSync, aerator comparison, shrimp farming, aquaculture, cost optimization, data visualization, PDF report">
  <meta name="author" content="Luis Vinatea">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="AeraSync">
  <meta name="theme-color" content="#1E40AF">

  <meta property="og:title" content="AeraSync - Aerator Comparison for Shrimp Farming">
  <meta property="og:description" content="AeraSync: Compare aerators for shrimp farming with a step-by-step survey, view ranked results, and download a detailed PDF report.">
  <meta property="og:image" content="https://luisvinatea.github.io/AeraSync/icons/aerasync512.webp">
  <meta property="og:url" content="https://luisvinatea.github.io/AeraSync/">
  <meta property="og:type" content="website">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="AeraSync - Aerator Comparison for Shrimp Farming">
  <meta name="twitter:description" content="AeraSync: Compare aerators for shrimp farming with a step-by-step survey, view ranked results, and download a detailed PDF report.">
  <meta name="twitter:image" content="https://luisvinatea.github.io/AeraSync/icons/aerasync512.webp">

  <link rel="apple-touch-icon" sizes="180x180" href="/icons/aerasync180.webp">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/aerasync180.png">
  <link rel="apple-touch-icon" sizes="512x512" href="/icons/aerasync512.webp">
  <link rel="apple-touch-icon" sizes="512x512" href="/icons/aerasync512.png">
  <link rel="apple-touch-icon" sizes="1024x1024" href="/icons/aerasync1024.webp">
  <link rel="apple-touch-icon" sizes="1024x1024" href="/icons/aerasync1024.png">
  <link rel="icon" type="image/webp" href="/icons/aerasync64.webp">
  <link rel="icon" type="image/png" href="/icons/aerasync64.png">
  <title>AeraSync - Aerator Comparison for Shrimp Farming</title>
  <link rel="manifest" href="/manifest.json">
  <link rel="preload" href="/flutter_bootstrap.js" as="script">
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div id="loading-screen" role="status" aria-label="Loading AeraSync application">
    <div class="wave-overlay"></div>
    <div class="loading">
      <picture>
        <source srcset="/icons/aerasync.webp" type="image/webp">
        <img src="/icons/aerasync.png" alt="AeraSync Logo - A stylized wave representing water and aeration" style="width: 200px; height: auto; margin-bottom: 20px;" loading="lazy">
      </picture>
      <h1 lang="en">AeraSync</h1>
      <p lang="en">Aerator Comparison for Shrimp Farming</p>
      <div class="spinner" aria-hidden="true"></div>
    </div>
  </div>

  <div id="cookies-consent">
    <p>We use cookies and tracking to improve your experience and analyze usage. Your data will help us enhance AeraSync. <a href="/privacy.html" target="_blank">Learn More</a></p>
    <label>
      <input type="checkbox" id="data-disclosure" onchange="handleDataDisclosure()">
      I agree to the use of cookies and data tracking (required to view results).
    </label>
    <button onclick="acceptCookies()">Accept</button>
  </div>

  <div id="app-container"></div>

  <script src="flutter_bootstrap.js" async></script>

  <script>
    // Register Service Worker for PWA capabilities
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/flutter_service_worker.js')
          .then(function(registration) {
            console.log('Service Worker registered with scope: ', registration.scope);
          })
          .catch(function(error) {
            console.log('Service Worker registration failed: ', error);
          });
      });
    }

    // Prevent default browser handling for multi-touch
    document.addEventListener('touchstart', function(event) {
      if (event.touches.length > 1) {
        event.stopPropagation();
      }
    }, { passive: false });

    // Handle loading screen
    window.addEventListener('flutter-first-frame', function() {
      var loadingScreen = document.getElementById('loading-screen');
      var appContainer = document.getElementById('app-container');
      if (loadingScreen) {
        loadingScreen.style.opacity = '0';
      }
      if (appContainer) {
        appContainer.style.display = 'block';
      }
      setTimeout(function() {
        if (loadingScreen) {
          loadingScreen.style.display = 'none';
        }
      }, 500);
    });

    // Cookies consent logic
    document.addEventListener('DOMContentLoaded', function() {
      if (!localStorage.getItem('cookiesAccepted')) {
        document.getElementById('cookies-consent').style.display = 'block';
      }
    });

    let dataDisclosureAgreed = false;
    function handleDataDisclosure() {
      dataDisclosureAgreed = document.getElementById('data-disclosure').checked;
      // Notify Flutter of disclosure agreement (via JS interop if needed)
      if (window.flutter_inappwebview) {
        window.flutter_inappwebview.callHandler('setDisclosureAgreement', dataDisclosureAgreed);
      }
    }

    function acceptCookies() {
      localStorage.setItem('cookiesAccepted', 'true');
      document.getElementById('cookies-consent').style.display = 'none';
      // Notify Flutter that cookies have been accepted (via JS interop if needed)
      if (window.flutter_inappwebview) {
        window.flutter_inappwebview.callHandler('onCookiesAccepted');
      }
    }
  </script>
</body>
</html>